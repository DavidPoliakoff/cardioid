simulate SIMULATE {
   anatomy = pioAnatomy;
   decomposition = grid;
   diffusion = Saleheen98Fast;
   reaction = TT04_CellML;
   sensor = pointSensor;
   stimulus = pointStimulus;
   loop = 0;
   maxLoop = 12000000;
   dt = 0.0050; //msec
   time = 0;
   printRate = 10000;
   snapshotRate = 10000000;
}

pioAnatomy ANATOMY {
   method = pio;
   fileName = snapshot.initial/anatomy#;
   cellTypes = -1;
   dx = 0.1; // in millimeters
   dy = 0.1; // in millimeters
   dz = 0.1; // in millimeters
}

koradi DECOMPOSITION {
   method = koradi;
   nCenters = 8000;
   alpha = 0.5;
   voronoiSteps = 3;
   koradiSteps = 2;
}

grid DECOMPOSITION {
    method = grid;
    nx = 1;
    ny = 1;
    nz = 16;
    ninner = 2;
    threshold = 2;
    visgrid = 0;
}

Saleheen98Fast DIFFUSION
{
   method = Saleheen98;
   variant = precompute;
   conductivity = uniform;
   diffusionScale = 250.0;
}

conductivity CONDUCTIVITY
{
    method = fibre;
    sigmaLi = 0.3;   // units S/m
    sigmaTi = 0.03;  // units S/m
}

uniform CONDUCTIVITY
{
    method = uniform;
    sigma11 = 0.0;       // S/mm
    sigma22 = 0.0;       // S/mm
    sigma33 = 6.1728E-4; // S/mm
    sigma12 = 0.0;
    sigma13 = 0.0;
    sigma23 = 0.0;
}

jhu CONDUCTIVITY
{
    method = JHU;
    sigmaLi = 0.0315;
    sigmaTi = 0.3;
    sheetAngle = 45;
    rotationMatrix = 1;
    homogeneousFiber = 0;
}

tenTusscher04 REACTION
{
    method = tenTusscher04_bb;
}

TT04_CellML REACTION
{
    method = TT04_CellML;
    integrator = rushLarsen;
}

pointSensor SENSOR
{
  method = pointlist;
  pointlist = 13 22 400 3604; // gids to print out
  startTime = 0.0;   // in ms
  printRate = 100;    // in timesteps
  filebase = sensorData/vm_vs_t_tab2_1-2;
  printDerivs = 1;
}

pointStimulus STIMULUS
{
  method = point;
  cell = 13;
  freq = 1000.0;
  duration = 1.0;
  iStim = -52.0;
  tStart = 0.0;
}
